<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>upload</title>

  <!-- Fonts -->
   <link href="https://fonts.googleapis.com/css2?family=Assistant&display=swap" rel="stylesheet" />

  <!-- Theme toggle logic (inlined instead of external file) -->
  <script defer>
    const THEME_KEY = "theme";
    const DARK = "dark";
    const LIGHT = "sunlight";

    const html = document.documentElement;

    function getPreferredTheme() {
      const stored = localStorage.getItem(THEME_KEY);
      if (stored) return stored;

      const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
      return prefersDark ? DARK : LIGHT;
    }

    function applyTheme(theme) {
      if (theme === LIGHT) {
        html.classList.add("sunlight");
      } else {
        html.classList.remove("sunlight");
      }
      html.setAttribute("data-theme", theme);
    }

    function toggleTheme() {
      const current = html.getAttribute("data-theme") || getPreferredTheme();
      const newTheme = current === DARK ? LIGHT : DARK;

      applyTheme(newTheme);
      localStorage.setItem(THEME_KEY, newTheme);
    }

    window.addEventListener("storage", (e) => {
      if (e.key === THEME_KEY) {
        applyTheme(e.newValue);
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      applyTheme(getPreferredTheme());

      const button = document.getElementById("theme-switch");
      if (button) {
        button.addEventListener("click", toggleTheme);
      }
    });
  </script>

    <style>
    
    :root {
      --base-color: linear-gradient(180deg, #360000, #130101);
      --text-color: white;
      --fill-color: #fff7f7;
      --base-variant: #ff2222;
    }

    html.sunlight {
      --base-color: linear-gradient(180deg, #fff6eeff, #ffded9 );;
      --text-color: #B51111;
      --fill-color: #550000;
      --base-variant: #edbfbf;
    }
        .columnnumbers {
            width: 30px;
            margin-right: 20px;
            margin-left: 5px;
        }
        .container {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            border-radius: 12px;
        }
        table, th, td {
            border: 1px solid black;
            border-collapse: collapse;
            padding: 5px;
            text-align: center;
        }
        
        button {
  background-color: #B51111;
  color: white;
  border: none;
  padding: 12px 24px;
  font-size: 20px;
  border-radius: 12px;
  cursor: pointer;
  font-family: 'Monaco', monospace;
  transition: background-color 0.3s ease;
}

button:hover:not(:disabled) {
  background-color: #E53935;
}

button:disabled {
  background-color: #aaa;
  cursor: not-allowed;
  opacity: 0.7;
}


p{
color: var(--text-color);
}
	/* Style the tab */
	.tab {
	  overflow: hidden;
	  border: 1px solid #ccc;
	  background-color: #B51111;
	}
	
	/* Style the buttons inside the tab */
	.tab button {
	  background-color: inherit;
	  float: left;
	  border: none;
	  outline: none;
	  cursor: pointer;
	  padding: 14px 16px;
	  transition: 0.3s;
	  font-size: 22px;
	}
	
	/* Change background color of buttons on hover */
	.tab button:hover {
	  background-color: #ddd;
	}
	
	/* Create an active/current tablink class */
	.tab button.active {
	  background-color: #B51111;
	}
	
	/* Style the tab content */
	.tabcontent {
	  display: none;
	  padding: 6px 12px;
	  border: 1px solid #ccc;
	  border-top: none;
	}
	
	.timesContainer {
	  margin-right: 50px;
	}

    h1 {
        font-size: 50px;
    }

    h2 {
        font-size: 30px;
    }

    p {
        font-size: 22px;
    }
  
  body{
  font-family: 'Assistant', sans-serif;
  }

.columnnumbers {
font-size: 22px; 
font-family: Times New Roman;
width:50px;
}

    input[type="file"] {
        font-size: 18px; /* Increase text size */
        cursor: pointer; /* Make it clickable */
    }

  #dynamicContainer {
        display: flex;
        flex-direction: row;
        gap: 30px;
        margin-top: 20px;
    }

    #troubleshoot {
        color: red;
        font-weight: bold;
    }
.header {
      background: linear-gradient(135deg, #B51111, #E53935); /* red gradient */
      text-align: center;
      padding: 1px ;
      border-radius: 12px;
      margin: 5px auto;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      font-size: 1.5 rem;
    }
    #theme-switch svg {
  display: none;
}

html[data-theme="dark"] #theme-switch svg:first-child {
  display: block; /* Show moon icon in dark mode */
}

html[data-theme="sunlight"] #theme-switch svg:last-child {
  display: block; /* Show sun icon in light mode */
}

    
    </style>

</head>
<body style="margin: 20px; background-image:var(--base-color);">

<div class="header">
    <h1 style="color:white;  text-align: center;">SMCS Symposium Schedule Generator</h1>
    
    <button id="theme-switch" aria-label="Toggle Theme">
    <!-- Moon icon (dark mode) -->
    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
      <path d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Z"/>
    </svg>
    <!-- Sun icon (light mode) -->
    <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px">
      <path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z"/>
    </svg>
  </button>
    </div>

    <h2 style="color:var(--text-color)">Senior Responses - Add Spreadsheet</h2>
    <p>Download the spreadsheet as a csv file and upload it here</p>

    <form id="uploadForm" enctype="multipart/form-data">
    	<input class="custom-file-upload" type="file" id="csvFile" accept=".csv" required>
	</form>
    
    <p>OR</p>
    
    <p>Make the spreadsheet public using a personal (non-MCPS) account and enter the link below</p>
    <input id="spreadsheetUrl" type="text" name="url" style="width:100%; font-size: 22px;" placeholder="Paste spreadsheet csv here..." value="https://docs.google.com/spreadsheets/d/e/2PACX-1vSUTvl8O4D9cuNTR1MBYAu8CgRzM_sI6eK29hoPriy-4edUpz7YUSDL80wLqxBszu0RLV2YYMLgL3pK/pub?output=csv">
    
    <br><br><br>
    <hr>
    <h2 style="color:var(--text-color)">Senior Responses - Columns</h2>
    <p>Number of column containing...</p>
    <form id="columnForm1" class="container" id="columnForm" style="font-size: 22px;">
        <p>Last name</p> <input type="number" id="lastName" style="font-size: 22px;" class="columnnumbers" value="3">
        <p>First name</p> <input type="number" id="firstName" style="font-size: 22px;" class="columnnumbers" value="4">
        <p>Name of project</p> <input type="number" id="projectName" style="font-size: 22px;" class="columnnumbers" value="5">
        <p>Project topic</p> <input type="number" id="projectTopic" style="font-size: 22px;" class="columnnumbers" value="6">
        <p>Blurb about project</p> <input type="number" id="blurb" style="font-size: 22px;" class="columnnumbers" value="18">
    </form>
    <form id="columnForm2" class="container" id="columnForm" style="font-size: 22px;">
        <p>Availability</p> <input type="number" id="availability" style="font-size: 22px;" class="columnnumbers" value="7">
        <p>Presider of Choice</p> <input type="number" id="presider" class="columnnumbers" value="8">
    	<p>Presider Introduction</p> <input type="number" id="presiderIntro" style="font-size: 22px;" class="columnnumbers" value="10">
        <p>Presenting with friend(s)</p> <input type="number" id="friends" style="font-size: 22px;" class="columnnumbers" value="15">
    </form>

    <br>
    <hr>
    
    
    <h2 style="color:var(--text-color)">Junior Responses - Add Spreadsheet</h2>
    <p>Download the spreadsheet as a csv file and upload it here</p>

    <form id="juniorUploadForm" enctype="multipart/form-data">
    	<input class="custom-file-upload" type="file" id="juniorCsvFile" accept=".csv" required>
	</form>
    
    <p>OR</p>
    
    <p>Make the spreadsheet public using a personal (non-MCPS) account and enter the link below</p>
    <input id="juniorSpreadsheetUrl" type="text" name="url" style="width:100%; font-size: 22px;" placeholder="Paste spreadsheet csv here..." value="https://docs.google.com/spreadsheets/d/e/2PACX-1vQ7CKfSEaLsaw7I5GanMCMe8fU6DvOY79LIOAE7PnvSebb9kY51aVsDNShD7oMG6KLs29b811ijnDx7/pub?gid=0&single=true&output=csv">
    
    <br><br><br>
    <hr>
    <h2 style="color:var(--text-color)">Junior Responses - Columns</h2>
    <p>Number of column containing...</p>
    <form id="columnForm3" class="container" id="columnForm" style="font-size: 22px;">
        <p>Last name</p> <input type="number" id="juniorLastName" style="font-size: 22px;" class="columnnumbers" value="1">
        <p>First name</p> <input type="number" id="juniorFirstName" style="font-size: 22px; " class="columnnumbers" value="2">
        <p>Preferred Topics</p> <input type="number" id="juniorTopics" style="font-size: 22px; " class="columnnumbers" value="3">
        <p>Availability</p> <input type="number" id="juniorAvailability" style="font-size: 22px; " class="columnnumbers" value="4">
    </form>
    <br>
    <hr>
    
    
    
    <h2 style="color:var(--text-color)">Rooms</h2>
    <p>Enter each room the symposium will be held in on a separate line, using the same format as the text below.</p>
    <textarea id="roomsInput" style="width:200px; font-size:22px; border-radius:12px; padding: 5px; text-align: left;" rows="5">
Room 195
Room 198
Room 199
</textarea>

<br><br><br>
<hr>
<h2 style="color:var(--text-color)">All Possible Times</h2>
<p>Enter all possible times the symposium can be held in the text box below, using the same format.
<br>
Days are separated by a single empty line.
</p>
<textarea id="timesInput" style="width:400px; font-size:22px; border-radius:12px; padding: 9px;" rows="15">
PD 2, Tuesday, December 19th
PD 3, Tuesday, December 19th
PD 4, Tuesday, December 19th
PD 5, Tuesday, December 19th
PD 6, Tuesday, December 19th

PD 2, Thursday, December 21st
PD 3, Thursday, December 21st
PD 4, Thursday, December 21st
PD 5, Thursday, December 21st
PD 6, Thursday, December 21st
</textarea>


    <br><br>
    <button id="parseData" style="width:200px; font-size: 22px; font-family: Assistant; margin-right: 20px;" rows="5" disabled="true" onclick="parseData()">View Parsed Data</button>
    <button id="nextPage" style="width:200px; font-size: 22px; font-family: Assistant" rows="5" disabled="true" onclick="nextPage()">Next</button>
    <p id="troubleshoot" style="display: none;">Problems with input will appear here.</p>

   <script>
        function checkInputs() {
            // Get input elements
            const input20 = document.getElementById("csvFile").files.length;
            const input0 = document.getElementById("spreadsheetUrl").value;
            const input1 = document.getElementById("lastName").value.trim();
            const input2 = document.getElementById("firstName").value.trim();
            const input3 = document.getElementById("projectName").value.trim();
            const input4 = document.getElementById("projectTopic").value.trim();
            const input5 = document.getElementById("availability").value.trim();
            const input6 = document.getElementById("friends").value.trim();
            const input7 = document.getElementById("blurb").value.trim();
            const input8 = document.getElementById("roomsInput").value.trim();
            const input9 = document.getElementById("timesInput").value.trim();
            const input10 = document.getElementById("presider").value.trim();
            const input11 = document.getElementById("presiderIntro").value.trim();
            
            const input30 = document.getElementById("juniorCsvFile").files.length;
            const input31 = document.getElementById("juniorSpreadsheetUrl").value;
            const input32 = document.getElementById("juniorLastName").value.trim();
            const input33 = document.getElementById("juniorFirstName").value.trim();
            const input34 = document.getElementById("juniorTopics").value.trim();
            const input35 = document.getElementById("juniorAvailability").value.trim();
            
            const button = document.getElementById("parseData");
	
            // Enable button if both fields have values
            button.disabled = !((input0 || (input20!=0)) && input1 && input2 && input3 && input4 && input5 && input6 && input7 && input8 && input9 && input10 && input11 && input32 && input33 && input34 && input35 && (input31 || (input30!=0)));
        }
	window.onload = function() {
	    checkInputs();
	};

        // Attach event listeners to inputs
        /*document.getElementById("lastName").addEventListener("input", checkInputs);
        document.getElementById("firstName").addEventListener("input", checkInputs);
        document.getElementById("url").addEventListener("input", checkInputs);
        document.getElementById("projectName").addEventListener("input", checkInputs);
        document.getElementById("projectTopic").addEventListener("input", checkInputs);
        document.getElementById("availability").addEventListener("input", checkInputs);
        document.getElementById("friends").addEventListener("input", checkInputs);
        document.getElementById("blurb").addEventListener("input", checkInputs);*/
        document.getElementById("csvFile").addEventListener("input", checkInputs);
        document.getElementById("spreadsheetUrl").addEventListener("input", checkInputs);
        document.getElementById("juniorCsvFile").addEventListener("input", checkInputs);
        document.getElementById("juniorSpreadsheetUrl").addEventListener("input", checkInputs);
        
        document.getElementById("columnForm1").addEventListener("input", checkInputs);
		document.getElementById("columnForm2").addEventListener("input", checkInputs);
        document.getElementById("columnForm3").addEventListener("input", checkInputs);
		document.getElementById("roomsInput").addEventListener("input", checkInputs);
        document.getElementById("timesInput").addEventListener("input", checkInputs);

	    
        function parseData() {
        	console.log("Sending data to backend...");
            // Get the textbox values
		document.getElementById("troubleshoot").style.display="none";
		
            var url = document.getElementById('spreadsheetUrl').value;
            if (!(url)) {
            	url="none";
            }
            
            const firstNameCol = document.getElementById('firstName').value;
            const lastNameCol = document.getElementById('lastName').value;
            const projectNameCol = document.getElementById('projectName').value;
            const projectTopicCol = document.getElementById('projectTopic').value;
            const availabilityCol = document.getElementById('availability').value;
            const friendsCol = document.getElementById('friends').value;
            const blurbCol = document.getElementById('blurb').value;
            const presiderCol = document.getElementById('presider').value;
	    	const presiderIntroCol = document.getElementById('presiderIntro').value;
        
        
           	var juniorUrl = document.getElementById('juniorSpreadsheetUrl').value;
            if (!(juniorUrl)) {
            	juniorUrl="none";
            }
            
        	const juniorFirstNameCol = document.getElementById('juniorFirstName').value;
            const juniorLastNameCol = document.getElementById('juniorLastName').value;
            const juniorTopicsCol = document.getElementById('juniorTopics').value;
            const juniorAvailabilityCol = document.getElementById('juniorAvailability').value;
        
		    
            const allTimes = document.getElementById('timesInput').value.trim().split('\n').map(t => t.trim()).filter(t => t !== '');
	    const allRooms = document.getElementById('roomsInput').value.trim().split('\n').map(t => t.trim()).filter(t => t !== '');

	    const timesRaw = document.getElementById("timesInput").value;
	    var days = [];
	    const lines = timesRaw.split("\n");
	    var currentDay = [];
	
	    for (let line of lines) {
		const trimmed = line.trim();
		if (trimmed === "") {
		    if (currentDay.length > 0) {
			days.push(currentDay);
			currentDay = [];
		    }
		} else {
		    currentDay.push(trimmed);
		}
	    }
	    if (currentDay.length > 0) {
		days.push(currentDay);
	    }
		
        const fileInput = document.getElementById("csvFile");
	var formData = new FormData();
	var csv="none";
        if (fileInput.files.length !=0) {
          formData.append("file", fileInput.files[0]);
	  csv="notnone";
        }
        
        const juniorFileInput = document.getElementById("juniorCsvFile");
	var juniorCsv="none";
        if (juniorFileInput.files.length !=0) {
          formData.append("juniorFile", juniorFileInput.files[0]);
	  	  juniorCsv="notnone";
        }
        
            // Prepare the data to send
            const data = {
		csv:csv,
        juniorCsv: juniorCsv,
        juniorUrl: juniorUrl,
                url: url,
                firstNameCol: firstNameCol,
                lastNameCol: lastNameCol,
                projectNameCol: projectNameCol,
                projectTopicCol: projectTopicCol,
                availabilityCol: availabilityCol,
                friendsCol: friendsCol,
                blurbCol: blurbCol,
                allTimes: allTimes,
                allRooms: allRooms,
                days: days,
		presiderCol: presiderCol,
		presiderIntroCol: presiderIntroCol,
        juniorFirstNameCol: juniorFirstNameCol,
        juniorLastNameCol: juniorLastNameCol,
        juniorTopicsCol: juniorTopicsCol,
        juniorAvailabilityCol: juniorAvailabilityCol
            };
            formData.append("json", JSON.stringify(data));
            console.log(JSON.stringify(data));
            
            // Send the data to the backend
            fetch('/parse_data', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log("✅ Received response from backend!"); 
		document.getElementById("troubleshoot").style.display="block";
		if (!response.ok) {
			document.getElementById("troubleshoot").innerText="An error occurred. Try the following: 1. Check that your csv link is correct. Click 'Instructions on getting a link' for help. 2. Please make sure your column numbers are correct. There should be at least one value in that column of the spreadsheet. The number of the leftmost column is 1. 3. If you are sure that you entered all inputs correctly, please fill out the following form: [insert form link here] to report the error. If possible, right click and hit Inspect Element, then go to the Console tab to retrieve the error message. We are very sorry for the inconvenience (unless ur member of capslocked in which case u get to tell the bozo programmer that they need to fix this IMMEDIATLEY).";	
			document.getElementById("nextPage").disabled=true;
		}
		else {
			document.getElementById("troubleshoot").style.display="none";
			document.getElementById("nextPage").disabled=false;
		}
		displayTable();
                return response.text();
            })
            .then(message => {
                console.log("📢 Backend says:", message);
                //alert(message); // still alert the user nicely
            })
            .catch(error => {
                console.error('❌ Error:', error);
                //alert('An error occurred. Please try again.');
    
            });

	}

  var allRooms;
  var displayAllTimes;
  var displayAllTimesFromData;
  var displayHeaders;
  var dataDict;

  var juniorDisplayAllTimes;
  var juniorDisplayAllTimesFromData;
  var juniorDisplayHeaders;
  var juniorDataDict;
	    
  var orderedIndices =[1,4,0,2,5,6,7];
  var juniorOrderedIndices = [0,1]; 
  var container = document.createElement("div");
	    
  function displayTable() {
    fetch('/getParsedData')
    .then(res => res.json())
    .then(data => {
      allRooms=data.allRooms;
      displayAllTimes=data.displayAllTimes;
      displayAllTimesFromData = data.displayAllTimesFromData;
      displayHeaders=data.displayHeaders;
      dataDict=data.dataDict;

      juniorDisplayAllTimes=data.juniorDisplayAllTimes;
      juniorDisplayAllTimesFromData = data.juniorDisplayAllTimesFromData;
      juniorDisplayHeaders=data.juniorDisplayHeaders;
      juniorDataDict=data.juniorDataDict;
      console.log(JSON.stringify(juniorDataDict));
      console.log(JSON.stringify(juniorDisplayAllTimesFromData));
      showParsedData();	
    })
    .catch(err => console.error("Failed to fetch room data:", err));	
  }
	    
  function showParsedData() {
     /* allRooms = ["Room 195", "Room 198", "Room 199"]
      displayAllTimes = [['PD 2, Tuesday, December 19th', 1], ['PD 3, Tuesday, December 19th', 1], ['PD 4, Tuesday, December 19th', 1], ['PD 5, Tuesday, December 19th', 1], ['PD 6, Tuesday, December 19th', 1], ['PD 2, Thursday, December 21st', 1], ['PD 3, Thursday, December 21st', 1], ['PD 4, Thursday, December 21st', 1], ['PD 5, Thursday, December 21st', 1], ['PD 6, Thursday, December 21st', 1]]

      displayAllTimesFromData = [['PD 6, Thursday, December 21st', 1], ['PD 6, Tuesday, December 19th', 1], ['PD 3, Tuesday, December 19th', 1], ['PD 5, Tuesday, December 19th', 1], ['PD 4, Tuesday, December 19th', 1], ['PD 4, Thursday, December 21st', 1], ['PD 3, Thursday, December 21st', 1], ['PD 2, Thursday, December 21st', 1], ['PD 2 Tuesday, December 19th', 1], ['PD 5, Thursday, December 21st', 1]]

      displayHeaders=['Senior Name', 'Project topic', 'Name of project', 'Availability', 'Presenting with a friend?','Blurb'];
      dataDict = {'Andrew Sha': [['PD 6, Tuesday, December 19th', 'PD 2, Thursday, December 21st', 'PD 4, Thursday, December 21st', 'PD 5, Thursday, December 21st', 'PD 6, Thursday, December 21st'], 'Neuroscience', ['Rohun Sarkar'], [], 'Extracting connectivity signatures of Parkinson’s disease using energy-based analysis', 'nan'], 'Alex Shelley': [['PD 4, Tuesday, December 19th', 'PD 5, Tuesday, December 19th', 'PD 6, Tuesday, December 19th', 'PD 4, Thursday, December 21st', 'PD 5, Thursday, December 21st', 'PD 6, Thursday, December 21st'], 'Biology', ['nan'], [], 'Effects of Biosolarization of Apple Pomace on Weed Suppression', 'nan'], 'Sachet Korada': [['PD 2 Tuesday, December 19th', 'PD 3, Tuesday, December 19th', 'PD 4, Tuesday, December 19th', 'PD 5, Tuesday, December 19th', 'PD 6, Tuesday, December 19th', 'PD 2, Thursday, December 21st', 'PD 3, Thursday, December 21st', 'PD 4, Thursday, December 21st', 'PD 5, Thursday, December 21st', 'PD 6, Thursday, December 21st'], 'Engineering', ['Patrick Le'], [], 'Developing a lightweight, robust, open source control system for a differential drive miniature unmanned ground vehicle', 'nan']};
  
      orderedIndices=[1,4,0,2] */

      container.innerHTML="";
      // Add the informational text
      const infoText = document.createElement("p");
      infoText.textContent = "Make sure this information is correct.";
      container.appendChild(infoText);

      // Create tab button container
      const tabContainer = document.createElement("div");
      tabContainer.classList.add("tab");

      // Create first button
      const button1 = document.createElement("button");
      button1.classList.add("tablinks");
      button1.setAttribute("onclick", "openData(event, 'Senior Responses')");
      button1.setAttribute("id", "defaultOpen");
      button1.textContent = "Senior Responses";
      tabContainer.appendChild(button1);


      // Create second button
      const button3 = document.createElement("button");
      button3.classList.add("tablinks");
      button3.setAttribute("onclick", "openData(event, 'Junior Responses')");
      //button3.setAttribute("id", "defaultOpen");
      button3.textContent = "Junior Responses";
      tabContainer.appendChild(button3);

      // Create third button
      const button2 = document.createElement("button");
      button2.classList.add("tablinks");
      button2.setAttribute("onclick", "openData(event, 'Rooms/Times')");
      button2.textContent = "Rooms/Times";
      tabContainer.appendChild(button2);

      container.appendChild(tabContainer);

      // Create tab content sections
      const seniorResponsesDiv = document.createElement("div");
      seniorResponsesDiv.classList.add("tabcontent");
      seniorResponsesDiv.setAttribute("id", "Senior Responses");

      const juniorResponsesDiv = document.createElement("div");
      juniorResponsesDiv.classList.add("tabcontent");
      juniorResponsesDiv.setAttribute("id", "Junior Responses");


      const roomsTimesDiv = document.createElement("div");
      roomsTimesDiv.classList.add("tabcontent");
      roomsTimesDiv.setAttribute("id", "Rooms/Times");

      container.appendChild(seniorResponsesDiv);
      container.appendChild(juniorResponsesDiv);
      container.appendChild(roomsTimesDiv);

      // Append the whole structure to the document body or a specific container
      document.body.appendChild(container);
      document.getElementById("defaultOpen").click();
  }


  function openData(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";

    if ((tabName)=="Senior Responses") {
      document.getElementById("Senior Responses").innerHTML = "";
      generateTable(displayHeaders, dataDict, orderedIndices, tabName);
    }
    
    if ((tabName)=="Junior Responses") {
      document.getElementById("Junior Responses").innerHTML = "";
      generateTable(juniorDisplayHeaders, juniorDataDict, juniorOrderedIndices, tabName);
    }

    if ((tabName)=="Rooms/Times") {
      document.getElementById("Rooms/Times").innerHTML = "";

      const directions = document.createElement("p");
      directions.textContent = "Make sure all timeslots that appear in responses are in the manually entered timeslots column (they appear green). The timeslots in the responses may not appear in the same order as the manually entered timeslots, but that is fine as long as the two columns contain the same information.";
      directions.style.color = "black";
      document.getElementById("Rooms/Times").appendChild(directions);

      const roomNames = document.createElement("h4");
      roomNames.textContent = "Rooms";
      roomNames.style.color = "black";
      document.getElementById("Rooms/Times").appendChild(roomNames);

      console.log(allRooms);	    
      allRooms.forEach((text) => {
	  const roomName = document.createElement("p");
	  roomName.textContent = text;
	  roomName.style.color = "green";
	  document.getElementById("Rooms/Times").appendChild(roomName);
      });

      const newContainer = document.createElement("div");
      newContainer.id = "dynamicContainer";  // Assign an ID if needed
      newContainer.style.display = "flex";
      newContainer.style.flexDirection="row";
      document.getElementById("Rooms/Times").appendChild(newContainer);  // Append it to the page

      const userContainer = document.createElement("div");
      userContainer.className="timesContainer";
      newContainer.appendChild(userContainer);
      // Now you can add your colored text inside it!

      const p = document.createElement("h4");
      p.textContent = "Manually Entered Timeslots";
      p.style.color = "black";
      userContainer.appendChild(p);

      displayAllTimes.forEach(([text, value]) => {
	  const p = document.createElement("p");
	  p.textContent = text;
	  p.style.color = value === 1 ? "green" : "red";
	  userContainer.appendChild(p);
      });

      const computerContainer = document.createElement("div");
      computerContainer.className="timesContainer";
      newContainer.appendChild(computerContainer);
      // Now you can add your colored text inside it!

      const q = document.createElement("h4");
      q.textContent = "All Timeslots in Senior Responses";
      q.style.color = "black";
      computerContainer.appendChild(q);

      displayAllTimesFromData.forEach(([text, value]) => {
	  const p = document.createElement("p");
	  p.textContent = text;
	  p.style.color = value === 1 ? "green" : "red";
	  computerContainer.appendChild(p);
      });
      
      const juniorContainer = document.createElement("div");
      juniorContainer.className="timesContainer";
      newContainer.appendChild(juniorContainer);
      // Now you can add your colored text inside it!

      const r = document.createElement("h4");
      r.textContent = "All Timeslots in Junior Responses";
      r.style.color = "black";
      juniorContainer.appendChild(r);

      juniorDisplayAllTimesFromData.forEach(([text, value]) => {
	  const p = document.createElement("p");
	  p.textContent = text;
	  p.style.color = value === 1 ? "green" : "red";
	  juniorContainer.appendChild(p);
      });

    }
  }

  function generateTable(displayHeaders, dataDict, orderedIndices, tabName) {
      const table = document.createElement("table");
      table.border = "1"; // Just for visibility

      // Create table header row
      console.log(displayHeaders);
      const headerRow = document.createElement("tr");
      displayHeaders.forEach(header => {
	  const th = document.createElement("th");
	  th.textContent = header;
	  headerRow.appendChild(th);
      });
      table.appendChild(headerRow);

      // Create rows with keys in the first column, followed by ordered values
      Object.entries(dataDict).forEach(([key, values]) => {
	  const row = document.createElement("tr");

	  // First cell contains the key
	  const keyCell = document.createElement("td");
	  keyCell.textContent = key;
	  row.appendChild(keyCell);

	  // Fill in the rest of the row based on ordered indices
	  orderedIndices.forEach(index => {
	      const valueCell = document.createElement("td");
	      valueCell.textContent = values[index] !== undefined ? values[index] : ""; // Handle missing values
	      row.appendChild(valueCell);
	  });

	  table.appendChild(row);
      });

      // Append table to the document body or a specific container
      document.getElementById(tabName).appendChild(table); // Change this if needed
  }

	function nextPage() {
		window.location.href = "logistics";
	}
    
    </script>
</body>
